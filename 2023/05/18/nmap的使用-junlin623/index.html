<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="https:&#x2F;&#x2F;www.cnblogs.com&#x2F;junlin623&#x2F;p&#x2F;17117705.html  title: ‘nmap的使用-junlin623’date: 2023-02-13 20:20:00      1 介绍Nmap，也就是Network Mapper，中文为“网络映射器”。Nmap是一款开源的网络探测和安全审核的工具，它的设计目标是快速地扫描大型网络。它是网络管理员必用的软件之一">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2023/05/18/nmap%E7%9A%84%E4%BD%BF%E7%94%A8-junlin623/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="https:&#x2F;&#x2F;www.cnblogs.com&#x2F;junlin623&#x2F;p&#x2F;17117705.html  title: ‘nmap的使用-junlin623’date: 2023-02-13 20:20:00      1 介绍Nmap，也就是Network Mapper，中文为“网络映射器”。Nmap是一款开源的网络探测和安全审核的工具，它的设计目标是快速地扫描大型网络。它是网络管理员必用的软件之一">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235554930-1405801684.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235558575-1307647333.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235606162-290066456.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235614366-1926982069.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235620883-298516524.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235631875-1338910120.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235640095-498162937.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235647530-1084255762.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235701670-1233930961.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235717575-1956780953.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235727503-398966428.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235732144-1228776142.png">
<meta property="article:published_time" content="2023-05-17T16:09:35.129Z">
<meta property="article:modified_time" content="2023-05-17T11:57:00.799Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235554930-1405801684.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-nmap的使用-junlin623" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/05/18/nmap%E7%9A%84%E4%BD%BF%E7%94%A8-junlin623/" class="article-date">
  <time class="dt-published" datetime="2023-05-17T16:09:35.129Z" itemprop="datePublished">2023-05-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/junlin623/p/17117705.html">https://www.cnblogs.com/junlin623/p/17117705.html</a></p>
<hr>
<p>title: ‘nmap的使用-junlin623’<br>date: 2023-02-13 20:20:00</p>
<hr>
<meta name = "referrer" content = "no-referrer" />



<h3 id="1-介绍"><a href="#1-介绍" class="headerlink" title="1 介绍"></a>1 介绍</h3><p>Nmap，也就是Network Mapper，中文为“网络映射器”。<br>Nmap是一款开源的网络探测和安全审核的工具，它的设计目标是快速地扫描大型网络。<br>它是网络管理员必用的软件之一，以及用以评估网络系统保安。</p>
<h4 id="1-1-基本功能"><a href="#1-1-基本功能" class="headerlink" title="1.1 基本功能"></a>1.1 基本功能</h4><p>（1）探测一组主机是否在线<br>（2）扫描主机端口，嗅探所提供的网络服务<br>（3）推断主机所用的操作系统</p>
<h4 id="1-2-工作原理"><a href="#1-2-工作原理" class="headerlink" title="1.2 工作原理"></a>1.2 工作原理</h4><p>Nmap对目标主机进行一系列的测试，利用测试结果建立相应目标主机的Nmap指纹，然后Nmap会对指纹进行匹配，最终输出相应的结果。</p>
<p><img src="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235554930-1405801684.png"></p>
<p><img src="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235558575-1307647333.png"></p>
<h4 id="1-3-语法格式"><a href="#1-3-语法格式" class="headerlink" title="1.3 语法格式"></a>1.3 语法格式</h4><p>Nmap的固定语法格式如下：</p>
<p><code>Nmap【空格】【选项|多选项|协议】【空格】【目标】</code></p>
<h3 id="2-常用参数"><a href="#2-常用参数" class="headerlink" title="2 常用参数"></a>2 常用参数</h3><p><img src="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235606162-290066456.png"></p>
<h4 id="2-1-全面扫描"><a href="#2-1-全面扫描" class="headerlink" title="2.1 全面扫描"></a>2.1 全面扫描</h4><p>全面扫描指定IP或域名的所有端口及其目标系统信息等。所需时间较长</p>
<p>  <code>nmap -A 192.168.0.12</code></p>
<p>扫描结果：目标主机MAC地址、设备类型、操作系统、中央处理单元、主机详细资料、网络距离等</p>
<h4 id="2-2-简单扫描"><a href="#2-2-简单扫描" class="headerlink" title="2.2 简单扫描"></a>2.2 简单扫描</h4><p>该扫描方式可以针对IP或者域名进行扫描，扫描方式迅速，可以很方便地发现目 标端口的开放情况及主机在线情况。</p>
<p><code>nmap 192.168.0.12</code></p>
<p>简单扫描结果：（只能扫描工具规定的一些常见端口）</p>
<p><img src="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235614366-1926982069.png"></p>
<h4 id="2-3-其他举例"><a href="#2-3-其他举例" class="headerlink" title="2.3 其他举例"></a>2.3 其他举例</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">指定扫描一个网段：nmap  192.168.0.0/24  或者  nmap  192.168.0.1-200（扫描1-200的主机）</span><br><span class="line"></span><br><span class="line">扫描部分网段（逗号隔开）：nmap 192.168.0.1,2,3,4 或 nmap 192.168.0,1,2,3,4.1 </span><br><span class="line"></span><br><span class="line">扫描指定IP所开放的端口：nmap -p 1-65535 -v 127.0.0.1 </span><br><span class="line"></span><br><span class="line">扫描C段存活主机：nmap 192.168.1.0/24 </span><br><span class="line"></span><br><span class="line">指定端口扫描：nmap -p 80,1433,22,1521 192.168.1.1 </span><br><span class="line"></span><br><span class="line">探测主机操作系统：nmap -O 192.168.1.1 </span><br><span class="line"></span><br><span class="line">全面的系统探测：nmap -v -A 192.168.1.1（Nmap默认扫描主机1000个高危端口）</span><br><span class="line"></span><br><span class="line">穿透防火墙进行扫描：nmap -Pn -A 192.168.1.1（禁止用ping的）</span><br><span class="line"></span><br><span class="line">使用脚本扫描Web敏感目录：nmap -p 80 --script=http-enum.nse 192.168.1.1</span><br></pre></td></tr></table></figure>

<h3 id="3-主机发现"><a href="#3-主机发现" class="headerlink" title="3 主机发现"></a>3 主机发现</h3><p><img src="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235620883-298516524.png"></p>
<h4 id="3-1-Ping扫描"><a href="#3-1-Ping扫描" class="headerlink" title="3.1 Ping扫描"></a>3.1 Ping扫描</h4><p>Ping扫描只进行ping，然后显示出在线的主机。使用该选项扫描可以轻易获取目标信息而不会被轻易发现。<br>在默认情况下，Nmap会发送一个ICMP回声请求和一个TCP报文到目标端口。Ping扫描的优点是不会返回太多的信息影响对结果的分析，并且扫描方式高效。</p>
<p><code>nmap -sP 192.168.0.0/24</code></p>
<h4 id="3-2-无Ping扫描"><a href="#3-2-无Ping扫描" class="headerlink" title="3.2 无Ping扫描"></a>3.2 无Ping扫描</h4><p>无ping扫描通常用于防火墙禁止ping的情况下，它能确定正在运行的机器。<br>默认情况下，nmap只对正在运行的主机进行高强度的探测，如端口扫描，版本探测或者操作系统探测。<br>用-P0禁止主机发现会使nmap对每一个特定的目标IP地址进行所要求的扫描，这可以穿透防火墙，也可以避免被防火墙发现。</p>
<p><code>nmap -P0 192.168.0.12</code></p>
<h4 id="3-3-TCP-SYN-Ping-扫描"><a href="#3-3-TCP-SYN-Ping-扫描" class="headerlink" title="3.3 TCP SYN Ping 扫描"></a>3.3 TCP SYN Ping 扫描</h4><p>通常情况下，nmap默认是使用TCP ACK 和 ICMP Echo 请求对目标进行是否存活的响应，当目标主机的防火墙阻止这些请求时，可以使用TCP SYN Ping扫描来判断主机是否存活。<br>-PS 选项发送一个设置了SYN标志位的空TCP报文。默认端口为80。<br>但不同的端口也可以作为选项指定，甚至可以指定一个以逗号分隔的端口列表（如-PS22,23,25,80,115,3306,3389），在这种情况下，每个端口会被并发地扫描</p>
<p><code>nmap -PS -v 192.168.0.12</code></p>
<p><img src="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235631875-1338910120.png"></p>
<p><img src="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235640095-498162937.png"></p>
<p>上面结果可得知Nmap是通过SYN&#x2F;ACK和RST响应来对目标主机是否存活进行判断，但在特定情况下防火墙会丢弃RST包。<br>这时结果会不准确，我们需要指定一个端口或端口范围来避免这种情况。</p>
<p><code>nmap -PS80,100-200 -v 192.168.0.12</code></p>
<p><img src="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235647530-1084255762.png"></p>
<h4 id="3-4-TCP-ACK-Ping-扫描"><a href="#3-4-TCP-ACK-Ping-扫描" class="headerlink" title="3.4 TCP ACK Ping 扫描"></a>3.4 TCP ACK Ping 扫描</h4><p>使用-PA选项可以进行TCP ACK Ping扫描，它与TCP SYN Ping扫描非常类似，区别在于设置的TCP标志位是ACK而不是SYN，使用这种方式扫描可以探测阻止SYN包或ICMP Echo请求的主机。</p>
<p><code>nmap -PA -v 192.168.0.12</code></p>
<p>同时使用-SP与-PA选项命令如下：</p>
<p><code>nmap -PA -PS 192.168.0.12</code></p>
<h4 id="3-5-UDP-Ping扫描"><a href="#3-5-UDP-Ping扫描" class="headerlink" title="3.5 UDP Ping扫描"></a>3.5 UDP Ping扫描</h4><p>使用UDP Ping扫描时Nmap会发送一个空UDP包到目标之间，如果目标主机相应则返回一个ICMP端口不可达错误，如果目标主机不是存活状态则会返回各自ICMP错误信息。</p>
<p><code>nmap -PU -v 192.168.0.12</code></p>
<h4 id="3-6-ICMP-Ping-Types-扫描"><a href="#3-6-ICMP-Ping-Types-扫描" class="headerlink" title="3.6 ICMP Ping Types 扫描"></a>3.6 ICMP Ping Types 扫描</h4><p>ICMP是控制报文协议。nmap发送一个ICMP type8（回声请求）报文到目标ip地址，从运行的主机得到一个type0（回声相应）报文。<br>-PE选项简单的来说是通过向目标发送ICMP Echo数据包来探测目标主机是否在线，使用-PE选项打开该回声请求功能。<br>-PP选项是ICMP时间戳ping扫描，-PM选项可以进行icmp地址掩码ping扫描</p>
<p><code>nmap  -PE  -v  192.168.0.12</code></p>
<p><code>nmap -PP  -v  192.168.0.12</code></p>
<p><code>nmap -PM -v  192.168.0.12</code></p>
<h4 id="3-7-ARP-Ping扫描"><a href="#3-7-ARP-Ping扫描" class="headerlink" title="3.7 ARP Ping扫描"></a>3.7 ARP Ping扫描</h4><p>-PR 通常在扫描局域网时使用，在内网的情况下，使用ARP ping扫描方式是最有效的，在本地局域网中防火墙不会禁止ARP请求，这就使得它比其他ping扫描都更加高效。</p>
<p><code>nmap -PR 192.168.0.12</code></p>
<h4 id="3-8-扫描列表"><a href="#3-8-扫描列表" class="headerlink" title="3.8 扫描列表"></a>3.8 扫描列表</h4><p>列表扫描时主机发现的退化形式，它仅仅列出指定网络上的每台主机，不发送任何报文到目标主机。<br>默认情况下，Nmap仍然对主机进行反向域名解析以获取它们的名字。</p>
<p><code>nmap -sL 192.168.0.0/24</code></p>
<h4 id="3-9-禁止反向域名解析"><a href="#3-9-禁止反向域名解析" class="headerlink" title="3.9 禁止反向域名解析"></a>3.9 禁止反向域名解析</h4><p>如果单纯扫描一段IP，使用该选项可以大幅度减少目标主机的相应时间，从而更快的得到结果。</p>
<p><code>namp -n -sL 192.168.0.0/24</code></p>
<h4 id="3-10反向域名解析"><a href="#3-10反向域名解析" class="headerlink" title="3.10反向域名解析"></a>3.10反向域名解析</h4><p><code>nmap -R -sL *. 192.168.0.0/24</code></p>
<h4 id="3-11-扫描TPv6地址"><a href="#3-11-扫描TPv6地址" class="headerlink" title="3.11 扫描TPv6地址"></a>3.11 扫描TPv6地址</h4><p><code>nmap -6 fe80::20c:29ff:fee0:2e76</code></p>
<h4 id="3-12-路由跟踪"><a href="#3-12-路由跟踪" class="headerlink" title="3.12 路由跟踪"></a>3.12 路由跟踪</h4><p>通过此选项可以轻松地查找出本地计算机到目标之间所经过的网络节点，并可以看到通过各个节点的时间。</p>
<p><code>nmap --traceroute -v www.baidu.com</code></p>
<h4 id="3-13-SCTP-INIT-Ping扫描"><a href="#3-13-SCTP-INIT-Ping扫描" class="headerlink" title="3.13 SCTP INIT Ping扫描"></a>3.13 SCTP INIT Ping扫描</h4><p>SCTP（流控制传输协议）是IETF在2000年定义的一个传输层协议。<br>SCTP可以看作是TCP协议的改进，它改进了TCP的一些不足，SCTP INIT Ping扫描通过向目标发送INIT包，根据目标主机的相应判断目标主机是否存活。</p>
<p><code>nmap -PY -v 192.168.0.12</code></p>
<h3 id="4-端口扫描"><a href="#4-端口扫描" class="headerlink" title="4 端口扫描"></a>4 端口扫描</h3><p><img src="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235701670-1233930961.png"></p>
<h4 id="4-1-从nmap识别端口状态"><a href="#4-1-从nmap识别端口状态" class="headerlink" title="4.1 从nmap识别端口状态"></a>4.1 从nmap识别端口状态</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Open：对外开放</span><br><span class="line">Closed：端口关闭状态</span><br><span class="line">Filtered：防火墙过滤或者网络堵塞</span><br><span class="line">Unfiltered：未被过滤，端口可访问，但是无法判断是开放还是关闭状态</span><br><span class="line">Open|Filtered：开放还是被过滤</span><br><span class="line">Closed|Filtered：不能确定是关闭还是被过滤，只可能出现在IPID Idle扫描中。</span><br></pre></td></tr></table></figure>

<h4 id="4-2-时序选项"><a href="#4-2-时序选项" class="headerlink" title="4.2 时序选项"></a>4.2 时序选项</h4><p>在nmap中使用-T（0-5）可以启用时序选项，对于时序选项这里有0~5不同选项。</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-T0（偏执的）：非常慢的扫描，用于IDS逃避。 </span><br><span class="line">-T1（鬼祟的）：缓慢的扫描，用于IDS逃避。 </span><br><span class="line">-T2（文雅的）：降低速度以降低对带宽的消耗，此选项不常用。 </span><br><span class="line">-T3（普通的）：默认，根据目标的反应自动调整时间。 </span><br><span class="line">-T4（野蛮的）：快速扫描，常用扫描方式，需要在很好的网络环境下进行扫描，请求可能会淹没目标。 </span><br><span class="line">-T5（疯狂的）：极速扫描，这种扫描方式以牺牲准确度来提示扫描速度。</span><br></pre></td></tr></table></figure>

<h4 id="4-3-TCP-SYN-扫描"><a href="#4-3-TCP-SYN-扫描" class="headerlink" title="4.3 TCP SYN 扫描"></a>4.3 TCP SYN 扫描</h4><p>半开放扫描，扫描速度快，扫描方式隐蔽。（在SYN扫描不能用时，TCP连接扫描会使用默认的TCP扫描）</p>
<p><code>nmap -sS 192.168.0.12</code></p>
<h4 id="4-4-TCP-连接扫描"><a href="#4-4-TCP-连接扫描" class="headerlink" title="4.4 TCP 连接扫描"></a>4.4 TCP 连接扫描</h4><p>端口扫描中最基础，最稳定的扫描方式</p>
<p><code>nmap -sT 192.168.0.12</code></p>
<h4 id="4-5-UDP扫描"><a href="#4-5-UDP扫描" class="headerlink" title="4.5 UDP扫描"></a>4.5 UDP扫描</h4><p>UDP扫描非常缓慢，UDP端口扫描通过发送UDP数据包到目标主机并等待响应，它将判断目标端口是否开放状态，如果目标返回ICMP不可达的错误，说明端口是关闭的，如果得到正确的适当的响应，这说明端口是开放的。</p>
<p><code>nmap -sU -p 80-500 192.168.0.12</code></p>
<h4 id="4-6-隐蔽扫描"><a href="#4-6-隐蔽扫描" class="headerlink" title="4.6 隐蔽扫描"></a>4.6 隐蔽扫描</h4><p>-sN是Null扫描，是通过发送非常规的TCP通信数据包对计算机进行探测，很多情况下Null扫描与Xmas扫描恰好相反，因为Null扫描不会标记任何数据包，若目标主机的相应端口是关闭的，会响应一个RST数据包，若目标端口是开放的则不会响应任何信息。</p>
<p><code>nmap -sN 192.168.0.12</code></p>
<p>-sF是FIN扫描，当我们使用TCP SYN扫描时可能会被目标主机的防火墙发现，会阻止SYN数据包，这时我们使用TCP FIN扫描方式会有很好的穿透效果，因为TCP FIN扫描并不需要完成TCP握手。TCP FIN扫描就是向目标端口发送一个FIN包，如果收到目标响应的RST包，则说明目标端口是开放的，如果没有收到RST包则说明目标端口是关闭的。</p>
<p><code>nmap -sF 192.168.0.12</code></p>
<p>-sX是Xmas扫描，数据包的FIN、PSH和URG标记位置打开，既标志位1，根据RFC 793规定如果目标主机端口是开放的则会响应一个RST标志包。</p>
<p><code>nmap -sX 192.168.0.12</code></p>
<h4 id="4-7-TCP-ACK-扫描"><a href="#4-7-TCP-ACK-扫描" class="headerlink" title="4.7 TCP ACK 扫描"></a>4.7 TCP ACK 扫描</h4><p>使用该扫描不能确定端口是否是开放还是被过滤的。</p>
<p><code>nmap -sA -v 192.168.0.12</code></p>
<h4 id="4-8-TCP-窗口扫描"><a href="#4-8-TCP-窗口扫描" class="headerlink" title="4.8 TCP 窗口扫描"></a>4.8 TCP 窗口扫描</h4><p>当收到RST包时，根据TCP窗口的值是正数还是0来判断目标端口是开放还是关闭的。<br>从输出结果来看是不准确的，如果扫描的端口都是开放状态或者只有少数几个是关闭状态就很不准确。</p>
<p><code>nmap -sW -v -F 192.168.0.12</code></p>
<h4 id="4-9-TCP-Maimon扫描"><a href="#4-9-TCP-Maimon扫描" class="headerlink" title="4.9 TCP Maimon扫描"></a>4.9 TCP Maimon扫描</h4><p>探测报文是FIN&#x2F;ACK 根据 RFC 793(TCP)，无论端口开放或者关闭，都应该对这样的探测响应RST报文，如果端口开放，许多基于BSD的系统只是丢弃该探测报文。</p>
<p><code>nmap -sM -T4 192.168.0.12</code></p>
<h4 id="4-10-自定义TCP扫描"><a href="#4-10-自定义TCP扫描" class="headerlink" title="4.10 自定义TCP扫描"></a>4.10 自定义TCP扫描</h4><p>可以通过指定任意的TCP标志位来进行扫描。</p>
<p><code>nmap -sT --scanflags SYNURG 192.168.0.12</code></p>
<h4 id="4-11-空闲扫描"><a href="#4-11-空闲扫描" class="headerlink" title="4.11 空闲扫描"></a>4.11 空闲扫描</h4><p>空闲扫描允许端口完全欺骗扫描。可以使攻击者能够不使用自己的IP向目标主机发送数据包，它可以利用不活跃的僵尸主机反弹给攻击者一个旁通信道，从而进行端口扫描。IDS会把不活跃的僵尸主机当做攻击者，这是一种非常隐蔽的扫描方法。</p>
<p><code>nmap -sI www.0day.co:80 192.168.0.12</code></p>
<p>这是利用僵尸主机为<a target="_blank" rel="noopener" href="http://www.0day.co的主机对192.168.0.12进行空闲扫描,如果有ids,ids则会把www.0day.co当做扫描者.选择的端口必须不能被自己的nmap主机或目标主机过滤掉并且必须为开放的./">www.0day.co的主机对192.168.0.12进行空闲扫描，如果有IDS，IDS则会把www.0day.co当做扫描者。选择的端口必须不能被自己的nmap主机或目标主机过滤掉并且必须为开放的。</a></p>
<h4 id="4-12-IP协议扫描"><a href="#4-12-IP协议扫描" class="headerlink" title="4.12 IP协议扫描"></a>4.12 IP协议扫描</h4><p>扫描IP协议号。IP协议扫描可以帮助用户确定目标主机哪些是支持IP协议的，例如TCP,ICMP.IGMP。虽然它遍历的是IP协议号并不是TCP或UDP端口，但仍可以使用-p选项选择需要扫描的协议号。它不是在UDP报文的端口域上循环，而时在IP协议域的2位上循环，发送空的IP报文头。</p>
<p><code>nmap -sO -T4 192.168.0.12</code></p>
<h4 id="4-13-FTP-Bounce扫描"><a href="#4-13-FTP-Bounce扫描" class="headerlink" title="4.13 FTP Bounce扫描"></a>4.13 FTP Bounce扫描</h4><p>使用-b选项就可以进行FTP Bounce Scan扫描。它允许用户连接到一台FTP服务器，然后要求文件送到一台第三方服务器，这种扫描方式被支持较少，但可绕过防火墙。</p>
<p><code>nmap -b 192.168.0.12</code></p>
<h3 id="5-指纹识别与探测"><a href="#5-指纹识别与探测" class="headerlink" title="5 指纹识别与探测"></a>5 指纹识别与探测</h3><p><img src="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235717575-1956780953.png"></p>
<h4 id="5-1-设置扫描强度"><a href="#5-1-设置扫描强度" class="headerlink" title="5.1 设置扫描强度"></a>5.1 设置扫描强度</h4><p>使用Nmap进行扫描的时候，Nmap发送一系列探测报文，–version-intensity选项可以为每个报文赋予1<del>9之间的值。<br>被赋予较低值的探测报文对大范围的常见服务有效，而被赋予较高值的报文一般没有实际作用，强度水平说明了应该使用哪些探测报文。<br>当我们赋予的值越高，服务越有可能被正确识别，但是这也会牺牲相当长的一段实际，强度必须在0</del>9，默认的强度是7。</p>
<p><code>nmap -sV --version-intensity 1 192.168.0.12</code></p>
<h4 id="5-2-RPC扫描"><a href="#5-2-RPC扫描" class="headerlink" title="5.2 RPC扫描"></a>5.2 RPC扫描</h4><p>该选项对用于与其他端口扫描选项相结合使用，它对所有被发现开放的TCP&#x2F;UDP端口执行SunRPC程序NULL命令，来试图确定它们是否为RPC端口，如果是RPC端口，则返回程序和版本号。</p>
<p><code>nmap -sS -sR 192.168.0.12</code></p>
<h4 id="5-3-对指定的目标进行操作系统检测"><a href="#5-3-对指定的目标进行操作系统检测" class="headerlink" title="5.3 对指定的目标进行操作系统检测"></a>5.3 对指定的目标进行操作系统检测</h4><p>使用–osscan-limit选项可以对指定的目标进行操作系统检测。<br>Nmap只对满足“具有打开和关闭的端口”条件的主机进行操作系统检测，这样可以节约时间，特别是在使用-P0扫描多个主机时。<br>这个选项仅在使用-O或-A进行操作系统检测时起作用。</p>
<p><code>nmap -O --osscan-limit 192.168.0.0/24</code></p>
<h3 id="6-躲避防火墙"><a href="#6-躲避防火墙" class="headerlink" title="6 躲避防火墙"></a>6 躲避防火墙</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">nmap -f -v 192.168.1.131 </span><br><span class="line">#报文分段，将TCP头分段在几个包中，IDS及其他工具监测更加困难</span><br><span class="line"></span><br><span class="line">nmap --mtu 16 192.168.1.131 </span><br><span class="line">#指定偏移大小，设置TCP/IP协议传输数据报时的最大传输单元，需要注意的是偏移量必须是8的倍数</span><br><span class="line"></span><br><span class="line">nmap -D 192.168.1.20,192.168.1.21,192.168.1.22,ME 192.168.1.131 </span><br><span class="line">#IP欺骗，在进行版本检测或者TCP扫描的时候诱饵是无效的 </span><br><span class="line">-D，指定诱饵ip，多个ip用逗号隔开</span><br><span class="line">ME，指定真实IP</span><br><span class="line"></span><br><span class="line">nmap -sI [www.baidu.com:80](http://www.baidu.com:80) 192.168.1.131 </span><br><span class="line">#源地址欺骗</span><br><span class="line"></span><br><span class="line">nmap --source-port 88 192.168.1.131 </span><br><span class="line">#源端口欺骗，指定一个比较安全的端口，nmap就可以从这些端口中发送数据</span><br><span class="line"></span><br><span class="line">nmap --data-length 30 192.168.1.131 </span><br><span class="line">#指定发包长度，通常TCP包是40字节，ICMP Echo是28字节</span><br><span class="line"></span><br><span class="line">nmap -sT -PN --spoof-mac 0 192.168.1.131 </span><br><span class="line">#MAC地址欺骗 </span><br><span class="line">0，随机MAC地址</span><br><span class="line">MAC Address，手动指定MAC地址</span><br><span class="line">Vendor Name，指定厂商生成MAC地址</span><br></pre></td></tr></table></figure>

<h3 id="7-保存与输出"><a href="#7-保存与输出" class="headerlink" title="7 保存与输出"></a>7 保存与输出</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#标准保存</span><br><span class="line">nmap -F  -oN  test1.txt  192.168.0.12 </span><br><span class="line">#XML保存</span><br><span class="line">nmap -F -oX test1.xml  192.168.0.12 </span><br><span class="line">#133t保存</span><br><span class="line">namp -F -oS test2.txt 192.168.0.12 </span><br><span class="line">#Grep保存</span><br><span class="line">nmap -F -oG test3.txt 192.168.0.12 </span><br><span class="line">#保存到所有格式</span><br><span class="line">nmap -F -oA  testA  192.168.0.12 </span><br><span class="line">#补充保存文件</span><br><span class="line">nmap -F --append-output -oN test1.txt 192.168.0.12</span><br></pre></td></tr></table></figure>

<h3 id="8-Nmap高级用法"><a href="#8-Nmap高级用法" class="headerlink" title="8 Nmap高级用法"></a>8 Nmap高级用法</h3><p><img src="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235727503-398966428.png"></p>
<h3 id="使用Nmap进行渗透测试"><a href="#使用Nmap进行渗透测试" class="headerlink" title="使用Nmap进行渗透测试"></a>使用Nmap进行渗透测试</h3><p><img src="https://img2018.cnblogs.com/blog/1561366/201908/1561366-20190801235732144-1228776142.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/05/18/nmap%E7%9A%84%E4%BD%BF%E7%94%A8-junlin623/" data-id="clhrwkubg001bi4szb1t6hlhb" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2023/05/18/Nmap%E4%BB%8B%E7%BB%8D%E4%B8%8E%E5%AE%89%E8%A3%85-junlin623/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2023/05/18/netstat%E5%91%BD%E4%BB%A4%E7%9A%84%E4%BD%BF%E7%94%A8%E4%BB%A5%E5%8F%8A%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90-junlin623/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/05/18/%E7%9B%B4%E8%BF%9E%E8%B7%AF%E7%94%B1%E8%A1%A8%E9%A1%B9%E8%A7%A3%E6%9E%90-junlin623/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/05/18/%E6%95%B4%E6%95%B0%E5%88%92%E5%88%86%E9%97%AE%E9%A2%98-junlin623/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/05/18/%E5%8E%9F%E7%94%9F%E6%96%B9%E5%BC%8F%E9%83%A8%E7%BD%B2JavaWeb%E9%A1%B9%E7%9B%AE%E5%88%B0%E8%BF%9C%E7%A8%8B%E4%B8%BB%E6%9C%BA-junlin623/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/05/18/%E5%8E%9F%E6%9D%A5%E6%98%AFvmware-hostd%E7%A8%8B%E5%BA%8F%E5%8D%A0%E7%94%A8%E4%BA%86443%E7%AB%AF%E5%8F%A3-junlin623/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/05/18/%E5%AD%A6%E7%94%9F%E5%8F%AF%E4%BB%A5%E7%99%BD%E5%AB%96%E9%98%BF%E9%87%8C%E4%BA%91ECS%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8D%8A%E5%B9%B4~~-junlin623/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>